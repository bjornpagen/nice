# Write an equation for lemon juice and sugar in a lemonade recipe

- **analysisId**: 667cdbdd-b1fb-4ec5-97cf-793bcff24729
- **questionId**: xffbcc7235e9653f8
- **severity**: minor

### Issue
all of the question responses are wrong when trying to use input fields. For inputs that expect equations, it's best that we give the user a dropdown of 4 equations to select from (with one being correct)

### Perseus (original)
```json
{
  "hints": [
    {
      "images": {},
      "content": "Let's find the constant  of proportionality.   \n\nIn the proportional relationship between $j$, the amount of lemon juice in $\\text{mL}$, and $s$, the amount of sugar in $\\text{g}$, one constant of proportionality is $\\text{g}$ of sugar per $\\text{mL}$ of lemon juice. It is also number we multiply by the amount of lemon juice to get the amount of sugar.\n\n$j \\,\\times\\, ?=s$",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "Lemon juice ($\\text{mL}$) | Sugar ($\\text{g}$) | Relationship\n:-: | :-: | :-:\n$500$ | $200$ |  $500\\times\\blueD{\\dfrac{2}{5}}=200$\n$750$ | $300$ | $750\\times\\blueD{\\dfrac{2}{5}}=300$\n$1500$ | $500$| $1500\\times\\blueD{\\dfrac{2}{5}}=500$\n\nThe constant of proportionality is $\\blueD{\\dfrac{2}{5}}$.  This means we can multiply $\\blueD{\\dfrac{2}{5}}$ by the amount of lemon juice to get the amount of sugar.",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "Now, let's represent that as an equation.  \n\n$\\begin{align}\n\\text{amount of sugar}&=\\blueD{\\text{constant of proportionality}}\\times\\text{amount of juice} \\\\\\\\\ns&=\\blueD{\\dfrac{2}{5}}j\n\\end{align}$",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "One correct equation is:\n\n$s =\\dfrac{2}{5}j$",
      "replace": false,
      "widgets": {}
    }
  ],
  "question": {
    "images": {},
    "content": "The table below shows the amount of lemon juice and sugar needed to make three different-sized batches of lemonade using the same recipe.\n\n| Lemon juice ($\\text{mL}$) | Sugar ($\\text{g}$) \n- | :-: | :-: |\nBatch A | $500$ | $200$ \nBatch B | $750$ | $300$\nBatch C | $1500$ | $600$\n\n**Write an equation to describe the relationship between $j$, the amount of lemon juice in milliliters, and $s$, the amount of sugar in grams.**  \n*Equations may include exact decimals,  proper fractions, or improper fractions. Please do NOT round or use mixed numbers.*\n\n[[☃ expression 1]]",
    "widgets": {
      "expression 1": {
        "type": "expression",
        "graded": true,
        "static": false,
        "options": {
          "times": false,
          "functions": [
            "f",
            "g",
            "h"
          ],
          "buttonSets": [
            "basic"
          ],
          "answerForms": [
            {
              "key": 0,
              "form": false,
              "value": "j=2.5s",
              "simplify": false,
              "considered": "correct"
            },
            {
              "key": 1,
              "form": false,
              "value": "s=0.4j",
              "simplify": false,
              "considered": "correct"
            }
          ]
        },
        "version": {
          "major": 1,
          "minor": 0
        },
        "alignment": "default"
      }
    }
  },
  "answerArea": {
    "tTable": false,
    "zTable": false,
    "chi2Table": false,
    "calculator": false,
    "periodicTable": false
  },
  "itemDataVersion": {
    "major": 0,
    "minor": 1
  }
}
```

### Structured JSON (generated)
```json
{
  "body": [
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "The table below shows the amount of lemon juice and sugar needed to make three different-sized batches of lemonade using the same recipe."
        }
      ]
    },
    {
      "type": "blockSlot",
      "slotId": "lemon_sugar_table"
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "Write an equation to describe the relationship between "
        },
        {
          "type": "math",
          "mathml": "<mi>j</mi>"
        },
        {
          "type": "text",
          "content": ", the amount of lemon juice in milliliters, and "
        },
        {
          "type": "math",
          "mathml": "<mi>s</mi>"
        },
        {
          "type": "text",
          "content": ", the amount of sugar in grams."
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "Equations may include exact decimals, proper fractions, or improper fractions. Please do NOT round or use mixed numbers."
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "Enter your equation: "
        },
        {
          "type": "inlineSlot",
          "slotId": "equation_entry"
        }
      ]
    }
  ],
  "title": "Write an equation for lemon juice and sugar in a lemonade recipe",
  "widgets": {
    "lemon_sugar_table": {
      "data": [
        [
          {
            "kind": "inline",
            "content": [
              {
                "type": "text",
                "content": "Batch A"
              }
            ]
          },
          {
            "kind": "number",
            "value": 500
          },
          {
            "kind": "number",
            "value": 200
          }
        ],
        [
          {
            "kind": "inline",
            "content": [
              {
                "type": "text",
                "content": "Batch B"
              }
            ]
          },
          {
            "kind": "number",
            "value": 750
          },
          {
            "kind": "number",
            "value": 300
          }
        ],
        [
          {
            "kind": "inline",
            "content": [
              {
                "type": "text",
                "content": "Batch C"
              }
            ]
          },
          {
            "kind": "number",
            "value": 1500
          },
          {
            "kind": "number",
            "value": 600
          }
        ]
      ],
      "type": "dataTable",
      "title": "Lemon juice and sugar amounts for lemonade batches",
      "footer": null,
      "columns": [
        {
          "key": "batch",
          "label": [
            {
              "type": "text",
              "content": "Batch"
            }
          ],
          "isNumeric": false
        },
        {
          "key": "lemon_ml",
          "label": [
            {
              "type": "text",
              "content": "Lemon juice (mL)"
            }
          ],
          "isNumeric": true
        },
        {
          "key": "sugar_g",
          "label": [
            {
              "type": "text",
              "content": "Sugar (g)"
            }
          ],
          "isNumeric": true
        }
      ],
      "rowHeaderKey": "batch"
    }
  },
  "feedback": {
    "correct": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Correct! One valid equation is "
          },
          {
            "type": "math",
            "mathml": "<mi>s</mi><mo>=</mo><mrow><mo>(</mo><mfrac><mn>2</mn><mn>5</mn></mfrac><mo>)</mo></mrow><mi>j</mi>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "This means the constant of proportionality is 0.4 grams of sugar per milliliter of lemon juice."
          }
        ]
      }
    ],
    "incorrect": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Not quite. Use any row in the table to find the constant of proportionality (sugar ÷ lemon juice): "
          },
          {
            "type": "math",
            "mathml": "<mfrac><mn>200</mn><mn>500</mn></mfrac><mo>=</mo><mfrac><mn>2</mn><mn>5</mn></mfrac><mo>=</mo><mn>0.4</mn>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Then write an equation such as "
          },
          {
            "type": "math",
            "mathml": "<mi>s</mi><mo>=</mo><mrow><mo>(</mo><mfrac><mn>2</mn><mn>5</mn></mfrac><mo>)</mo></mrow><mi>j</mi>"
          },
          {
            "type": "text",
            "content": " or "
          },
          {
            "type": "math",
            "mathml": "<mi>j</mi><mo>=</mo><mrow><mo>(</mo><mfrac><mn>5</mn><mn>2</mn></mfrac><mo>)</mo></mrow><mi>s</mi>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      }
    ]
  },
  "identifier": "lemonade-proportional-equation",
  "interactions": {
    "equation_entry": {
      "type": "textEntryInteraction",
      "expectedLength": 10,
      "responseIdentifier": "RESPONSE"
    }
  },
  "responseDeclarations": [
    {
      "correct": [
        "s=0.4j",
        "j=2.5s",
        "s=(2/5)j",
        "j=(5/2)s"
      ],
      "baseType": "string",
      "identifier": "RESPONSE",
      "cardinality": "single"
    }
  ]
}
```

### Relevant code
- Compiler finalization (missing URL hardening) — src/lib/qti-generation/compiler.ts
```
	finalXml = stripXmlComments(finalXml, logger)
	finalXml = removeDoubleNewlines(finalXml, logger)
	finalXml = fixMathMLOperators(finalXml, logger)
	finalXml = fixInequalityOperators(finalXml, logger)
	// Convert HTML entities to Unicode characters at the very end
	return convertHtmlEntities(finalXml, logger)
}

```
