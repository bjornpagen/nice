# Greatest common factor of 60 and 60

- **analysisId**: 63ba5412-c17b-455a-b054-699afbf691c5
- **questionId**: x6105f4c88f2586ef
- **severity**: patch

### Issue
The input should be on a new line.

### Perseus (original)
```json
{
  "hints": [
    {
      "images": {},
      "content": "The greatest common factor (GCF) is the largest number that is a factor of $60$ and $60$. \n\n",
      "widgets": {}
    },
    {
      "images": {},
      "content": "In order to find the GCF, we can factor each number completely as a product of prime numbers:\n\n$\\qquad \\begin{align}60 &=2\\cdot2\\cdot3\\cdot5\\\\\\\\\\\\\\\\\n60 &=2\\cdot2\\cdot3\\cdot5\n\\end{align}$\n\nThe results are the same because $60$ and $60$ are the same number!",
      "widgets": {}
    },
    {
      "images": {},
      "content": "Since $60=60$, the factors that are *common to* each number are the same:\n\n$\\qquad \\begin{align}60 &=\\pink2\\cdot\\pink2\\cdot\\pink3\\cdot\\pink5\\\\\\\\\\\\\\\\\n60 &=\\pink2\\cdot\\pink2\\cdot\\pink3\\cdot\\pink5\n\\end{align}$\n\nBoth numbers share all of their factors $\\pink{2}$, $\\pink{2}$, $\\pink{3}$, and $\\pink{5}$,  so the GCF is $\\pink2\\cdot\\pink2\\cdot\\pink3\\cdot\\pink5=\\pink{60}$.",
      "widgets": {}
    },
    {
      "images": {},
      "content": "The greatest common factor of $60$ and $60$ is $60$.\n\nIn general, the greatest common factor of any number and itself is that number.",
      "widgets": {}
    }
  ],
  "question": {
    "images": {},
    "content": "**Find the greatest common factor of $60$ and $60$.**\n\n[[☃ numeric-input 1]]",
    "widgets": {
      "expression 1": {
        "type": "expression",
        "graded": true,
        "options": {
          "times": false,
          "functions": [
            "f",
            "g",
            "h"
          ],
          "buttonSets": [
            "basic"
          ],
          "answerForms": [
            {
              "key": 0,
              "form": true,
              "value": "6",
              "simplify": false,
              "considered": "correct"
            }
          ]
        },
        "version": {
          "major": 1,
          "minor": 0
        }
      },
      "numeric-input 1": {
        "type": "numeric-input",
        "graded": true,
        "options": {
          "size": "normal",
          "answers": [
            {
              "value": 60,
              "status": "correct",
              "strict": false,
              "message": "",
              "maxError": null,
              "simplify": "required"
            }
          ],
          "labelText": "",
          "coefficient": false
        },
        "version": {
          "major": 0,
          "minor": 0
        }
      }
    }
  },
  "answerArea": {
    "type": "multiple",
    "options": {
      "images": {},
      "content": "",
      "widgets": {}
    },
    "calculator": false
  },
  "itemDataVersion": {
    "major": 0,
    "minor": 1
  }
}
```

### Structured JSON (generated)
```json
{
  "body": [
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "Find the greatest common factor of "
        },
        {
          "type": "math",
          "mathml": "<mn>60</mn>"
        },
        {
          "type": "text",
          "content": " and "
        },
        {
          "type": "math",
          "mathml": "<mn>60</mn>"
        },
        {
          "type": "text",
          "content": ". "
        },
        {
          "type": "inlineSlot",
          "slotId": "numeric_input_1"
        }
      ]
    }
  ],
  "title": "Greatest common factor of 60 and 60",
  "widgets": {},
  "feedback": {
    "correct": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Correct! The greatest common factor of "
          },
          {
            "type": "math",
            "mathml": "<mn>60</mn>"
          },
          {
            "type": "text",
            "content": " and "
          },
          {
            "type": "math",
            "mathml": "<mn>60</mn>"
          },
          {
            "type": "text",
            "content": " is "
          },
          {
            "type": "math",
            "mathml": "<mn>60</mn>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      }
    ],
    "incorrect": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "The greatest common factor (GCF) is the largest number that is a factor of both numbers."
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Prime factorize each number: "
          },
          {
            "type": "math",
            "mathml": "<mn>60</mn><mo>=</mo><mn>2</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>3</mn><mo>×</mo><mn>5</mn>"
          },
          {
            "type": "text",
            "content": " and "
          },
          {
            "type": "math",
            "mathml": "<mn>60</mn><mo>=</mo><mn>2</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>3</mn><mo>×</mo><mn>5</mn>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "All prime factors match, so multiply the common factors: "
          },
          {
            "type": "math",
            "mathml": "<mn>2</mn><mo>×</mo><mn>2</mn><mo>×</mo><mn>3</mn><mo>×</mo><mn>5</mn><mo>=</mo><mn>60</mn>"
          },
          {
            "type": "text",
            "content": ". The GCF is "
          },
          {
            "type": "math",
            "mathml": "<mn>60</mn>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      }
    ]
  },
  "identifier": "greatest-common-factor-60-60",
  "interactions": {
    "numeric_input_1": {
      "type": "textEntryInteraction",
      "expectedLength": null,
      "responseIdentifier": "RESPONSE"
    }
  },
  "responseDeclarations": [
    {
      "correct": 60,
      "baseType": "integer",
      "identifier": "RESPONSE",
      "cardinality": "single"
    }
  ]
}
```

### Relevant code
- Renderer (paragraph vs block slot) — src/lib/qti-generation/content-renderer.ts
```
		.join("")
}

export function renderBlockContent(blockItems: BlockContent | null | undefined, slots: Map<string, string>): string {
	if (!blockItems) return ""
	return blockItems
		.map((item) => {
			switch (item.type) {
				case "paragraph":
					return `<p>${renderInlineContent(item.content, slots)}</p>`
				case "blockSlot": {
					const content = slots.get(item.slotId)
					if (content === undefined) {
						throw errors.new(`Compiler Error: Content for block slot '${item.slotId}' not found.`)
					}
					return `<div>${content}</div>` // ALWAYS wrap block slots in a div
				}
			}
		})
		.join("\n        ")
}

```

- Compiler finalization (missing URL hardening) — src/lib/qti-generation/compiler.ts
```
	finalXml = stripXmlComments(finalXml, logger)
	finalXml = removeDoubleNewlines(finalXml, logger)
	finalXml = fixMathMLOperators(finalXml, logger)
	finalXml = fixInequalityOperators(finalXml, logger)
	// Convert HTML entities to Unicode characters at the very end
	return convertHtmlEntities(finalXml, logger)
}

```
