# Find the value of x in an isosceles triangle

- **analysisId**: 8c99461e-a47d-422a-84b8-f01329ee8890
- **questionId**: x6212194cf8844209
- **severity**: major

### Issue
The diagram fails to include the height "2", making the problem unsolvable for the student. The angles on the bottom left and right should have two angle arc lines (i.e., a double line), and the top angle should have one angle arc lines (i.e., a single line).

### Perseus (original)
```json
{
  "hints": [
    {
      "images": {},
      "content": "The isosceles triangle is made up of $2$ congruent right triangles. \n\n\n\n[[☃ image 1]]\n\nThe base of each right triangle is $\\dfrac12$ the base of the isosceles triangle.",
      "replace": false,
      "widgets": {
        "image 1": {
          "type": "image",
          "graded": true,
          "static": false,
          "options": {
            "alt": "A triangle with a base of x units and a height of 2 units. The other 2 sides of the triangle are the square root of 13 units.  A solid line goes from the center of the base straight up to the top vertex of the triangle. This straight line makes a right angle with the base which creates two right triangles. One right triangle is shaded green and the other right triangle is shaded purple.  The bottom left angle and bottom right angle are congruent.",
            "box": [
              240,
              139
            ],
            "range": [
              [
                0,
                10
              ],
              [
                0,
                10
              ]
            ],
            "title": "",
            "labels": [],
            "static": false,
            "caption": "",
            "backgroundImage": {
              "url": "web+graphie://cdn.kastatic.org/ka-perseus-graphie/eec4c3e2fb2a8207fee27d26058c0a22c59570f9",
              "width": 240,
              "height": 139
            }
          },
          "version": {
            "major": 0,
            "minor": 0
          },
          "alignment": "block"
        }
      }
    },
    {
      "images": {},
      "content": "When we have a right triangle we can use the Pythagorean Theorem to solve for a missing side.\n\nThe equation for the Pythagorean Theorem is \n\n>$a^2 + b^2  = c^2$\n\nwhere $a$ and $b$ are the lengths of the two legs of the triangle, and $c$ is the length of the hypotenuse.   \n[[☃ explanation 1]]",
      "replace": false,
      "widgets": {
        "explanation 1": {
          "type": "explanation",
          "graded": true,
          "static": false,
          "options": {
            "static": false,
            "widgets": {
              "image 1": {
                "type": "image",
                "graded": true,
                "static": false,
                "options": {
                  "alt": "A right triangle. The base and height are labeled leg. The longest side is labeled hypotenuse.",
                  "box": [
                    200,
                    167
                  ],
                  "range": [
                    [
                      0,
                      10
                    ],
                    [
                      0,
                      10
                    ]
                  ],
                  "title": "",
                  "labels": [],
                  "static": false,
                  "caption": "",
                  "backgroundImage": {
                    "url": "web+graphie://cdn.kastatic.org/ka-perseus-graphie/1fe06036222ca425cd0c672984225e31aa509700",
                    "width": 200,
                    "height": 167
                  }
                },
                "version": {
                  "major": 0,
                  "minor": 0
                },
                "alignment": "block"
              }
            },
            "hidePrompt": "Hide explanation",
            "showPrompt": "How can I tell which side is the hypotenuse?",
            "explanation": "The hypotenuse is the longest side and is  across from the right angle. The two legs are the shorter sides that form the right angle:\n\n\n[[☃ image 1]]\n\n"
          },
          "version": {
            "major": 0,
            "minor": 0
          },
          "alignment": "default"
        }
      }
    },
    {
      "images": {},
      "content": "First we can find the missing length for one of the right triangles. Let's label the drawing with $a$, $b$, and $c$:\n\n\n[[☃ image 1]]\n\n*Note that $a$ and $b$ could be switched because they are legs.*",
      "replace": false,
      "widgets": {
        "image 1": {
          "type": "image",
          "graded": true,
          "static": false,
          "options": {
            "alt": "A triangle with a height of 2 units, labeled b = 2. The other 2 sides of the triangle are the square root of 13 units. The right side is labeled c = square root of 13. A solid line goes from the center of the base straight up to the top vertex of the triangle. This straight line makes a right angle with the base which creates two right triangles. One right triangle is shaded purple. The base of the purple triangle is labeled a. The bottom left angle and bottom right angle are congruent.",
            "box": [
              240,
              129
            ],
            "range": [
              [
                0,
                10
              ],
              [
                0,
                10
              ]
            ],
            "title": "",
            "labels": [],
            "static": false,
            "caption": "",
            "backgroundImage": {
              "url": "web+graphie://cdn.kastatic.org/ka-perseus-graphie/976a368e49cd7e4e1d81082399ee65a8ec208239",
              "width": 240,
              "height": 129
            }
          },
          "version": {
            "major": 0,
            "minor": 0
          },
          "alignment": "block"
        }
      }
    },
    {
      "images": {},
      "content": "Let's use the Pythagorean Theorem to solve for $x$.\n\n$\\begin{align} \\blueD a^2 + \\greenD b^2 &= \\goldD c^2 ~~~~~~~~~~~\\small\\gray{\\text{The Pythagorean Theorem}}\\\\\\\\\n\\blueD{a}^2 + \\greenD{ 2}^2 &= (\\goldD{\\sqrt{13}})^2~~\\small\\gray{\\text{Plug in the side lengths}}\\\\\\\\\na^2   +4 &= 13 ~~~~~~~~~~\\small\\gray{\\text{Evaluate } 2^2 \\text{ and }  (\\sqrt{13})^2}\\\\\\\\\na^2 &= 9~~~~~~~~~~~~\\small\\gray{\\text{Subtract 4 from each side}}\\\\\\\\\na &= 3 ~~~~~~~~~~~~\\small\\gray{\\text{Take the square root of each side}}\\\\\\\\ \\\\\\end{align}$",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "Since $a=3$ and $a$ is half the length of $x$, we can multiply to find $x$.\n\n\n\n[[☃ image 1]]\n\n$\\begin{align}x & = a \\cdot 2 \\\\\\\nx & = 3 \\cdot 2 \\\\\\\nx  &= 6 \\end{align}$",
      "replace": false,
      "widgets": {
        "image 1": {
          "type": "image",
          "graded": true,
          "static": false,
          "options": {
            "alt": "A triangle with a base of 6 units and a height of 2 units. A solid line goes from the center of the base straight up to the top of the vertex of the triangle. This straight line makes a right angle with the base which creates two right triangles. One right triangle is shaded purple. The base of the purple triangle is labeled 3 units, the height is 2 units, and the longest side is the square root of 13 units. The bottom left angle and bottom right angle are congruent.",
            "box": [
              240,
              148
            ],
            "range": [
              [
                0,
                10
              ],
              [
                0,
                10
              ]
            ],
            "title": "",
            "labels": [],
            "static": false,
            "caption": "",
            "backgroundImage": {
              "url": "web+graphie://cdn.kastatic.org/ka-perseus-graphie/ba9e82ad41abdd50752ad690df41eab7cbab0377",
              "width": 240,
              "height": 148
            }
          },
          "version": {
            "major": 0,
            "minor": 0
          },
          "alignment": "block"
        }
      }
    },
    {
      "images": {},
      "content": "$x = 6$",
      "replace": false,
      "widgets": {}
    }
  ],
  "question": {
    "images": {},
    "content": "**Find the value of $x$ in the isosceles triangle shown below.**\n\n\n[[☃ image 1]]\n\n[[☃ radio 1]]",
    "widgets": {
      "image 1": {
        "type": "image",
        "graded": true,
        "static": false,
        "options": {
          "alt": "A triangle with a base of x units and a height of 2 units. The other 2 sides of the triangle are the square root of 13 units.  A dashed line goes from the center of the base straight up to the top vertex of the triangle.  The bottom left angle and bottom right angle are congruent.",
          "box": [
            240,
            131
          ],
          "range": [
            [
              0,
              10
            ],
            [
              0,
              10
            ]
          ],
          "title": "",
          "labels": [],
          "static": false,
          "caption": "",
          "backgroundImage": {
            "url": "web+graphie://cdn.kastatic.org/ka-perseus-graphie/3f28ca19d0fbf4215a60ab0784f5743eb38f6ac2",
            "width": 240,
            "height": 131
          }
        },
        "version": {
          "major": 0,
          "minor": 0
        },
        "alignment": "block"
      },
      "radio 1": {
        "type": "radio",
        "graded": true,
        "static": false,
        "options": {
          "choices": [
            {
              "content": "$x = \\sqrt{26}$",
              "correct": false
            },
            {
              "content": "$x = \\sqrt{52}$",
              "correct": false
            },
            {
              "content": "$x = 3$",
              "correct": false,
              "isNoneOfTheAbove": false
            },
            {
              "content": "$x = 6$",
              "correct": true,
              "isNoneOfTheAbove": false
            }
          ],
          "randomize": true,
          "countChoices": false,
          "displayCount": null,
          "multipleSelect": false,
          "deselectEnabled": false,
          "hasNoneOfTheAbove": false
        },
        "version": {
          "major": 1,
          "minor": 0
        },
        "alignment": "default"
      }
    }
  },
  "answerArea": {
    "tTable": false,
    "zTable": false,
    "chi2Table": false,
    "calculator": false,
    "periodicTable": false
  },
  "itemDataVersion": {
    "major": 0,
    "minor": 1
  }
}
```

### Structured JSON (generated)
```json
{
  "body": [
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "Find the value of "
        },
        {
          "type": "math",
          "mathml": "<mi>x</mi>"
        },
        {
          "type": "text",
          "content": " in the isosceles triangle shown below."
        }
      ]
    },
    {
      "type": "blockSlot",
      "slotId": "triangle_image"
    },
    {
      "type": "blockSlot",
      "slotId": "choice_interaction"
    }
  ],
  "title": "Find the value of x in an isosceles triangle",
  "widgets": {
    "triangle_image": {
      "type": "triangleDiagram",
      "sides": [
        {
          "label": "x",
          "vertices": [
            "A",
            "B"
          ],
          "tickMarks": 0
        },
        {
          "label": "√13",
          "vertices": [
            "A",
            "C"
          ],
          "tickMarks": 1
        },
        {
          "label": "√13",
          "vertices": [
            "B",
            "C"
          ],
          "tickMarks": 1
        }
      ],
      "width": 240,
      "angles": [
        {
          "color": "#000000",
          "label": "",
          "radius": 12,
          "showArc": true,
          "vertices": [
            "C",
            "A",
            "B"
          ],
          "isRightAngle": false
        },
        {
          "color": "#000000",
          "label": "",
          "radius": 12,
          "showArc": true,
          "vertices": [
            "A",
            "B",
            "C"
          ],
          "isRightAngle": false
        }
      ],
      "height": 131.25,
      "points": [
        {
          "x": 7.5,
          "y": 93.75,
          "id": "A",
          "label": ""
        },
        {
          "x": 232.5,
          "y": 93.75,
          "id": "B",
          "label": ""
        },
        {
          "x": 120,
          "y": 18.75,
          "id": "C",
          "label": ""
        },
        {
          "x": 120,
          "y": 93.75,
          "id": "D",
          "label": ""
        }
      ],
      "internalLines": [
        {
          "to": "D",
          "from": "C",
          "style": "dashed"
        }
      ],
      "shadedRegions": null
    }
  },
  "feedback": {
    "correct": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Correct! The altitude of an isosceles triangle bisects the base, so each half of the base is a leg of a right triangle with height "
          },
          {
            "type": "math",
            "mathml": "<mn>2</mn>"
          },
          {
            "type": "text",
            "content": " and hypotenuse "
          },
          {
            "type": "math",
            "mathml": "<msqrt><mn>13</mn></msqrt>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "math",
            "mathml": "<msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><msup><mi>b</mi><mn>2</mn></msup><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><mo>,</mo><mspace width=\"0.5em\"/><mi>b</mi><mo>=</mo><mn>2</mn><mo>,</mo><mspace width=\"0.5em\"/><mi>c</mi><mo>=</mo><msqrt><mn>13</mn></msqrt><mo>.</mo><mspace width=\"0.5em\"/><mo>⇒</mo><mspace width=\"0.5em\"/><msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><mn>4</mn><mo>=</mo><mn>13</mn><mo>⇒</mo><msup><mi>a</mi><mn>2</mn></msup><mo>=</mo><mn>9</mn><mo>⇒</mo><mi>a</mi><mo>=</mo><mn>3</mn><mo>.</mo><mspace width=\"0.5em\"/><mi>x</mi><mo>=</mo><mn>2</mn><mi>a</mi><mo>=</mo><mn>6</mn>"
          }
        ]
      }
    ],
    "incorrect": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Not quite. Draw the altitude from the apex; it makes two congruent right triangles and bisects the base."
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Use the Pythagorean Theorem on one right triangle: "
          },
          {
            "type": "math",
            "mathml": "<msup><mi>a</mi><mn>2</mn></msup><mo>+</mo><mn>4</mn><mo>=</mo><mn>13</mn><mo>⇒</mo><mi>a</mi><mo>=</mo><mn>3</mn>"
          },
          {
            "type": "text",
            "content": ", then double it for the full base: "
          },
          {
            "type": "math",
            "mathml": "<mi>x</mi><mo>=</mo><mn>2</mn><mi>a</mi><mo>=</mo><mn>6</mn>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      }
    ]
  },
  "identifier": "isosceles-triangle-find-x-radio",
  "interactions": {
    "choice_interaction": {
      "type": "choiceInteraction",
      "prompt": [
        {
          "type": "text",
          "content": "Select the correct value of "
        },
        {
          "type": "math",
          "mathml": "<mi>x</mi>"
        },
        {
          "type": "text",
          "content": "."
        }
      ],
      "choices": [
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "math",
                  "mathml": "<mi>x</mi><mo>=</mo><msqrt><mn>26</mn></msqrt>"
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "A"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "math",
                  "mathml": "<mi>x</mi><mo>=</mo><msqrt><mn>52</mn></msqrt>"
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "B"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "math",
                  "mathml": "<mi>x</mi><mo>=</mo><mn>3</mn>"
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "C"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "math",
                  "mathml": "<mi>x</mi><mo>=</mo><mn>6</mn>"
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "D"
        }
      ],
      "shuffle": true,
      "maxChoices": 1,
      "minChoices": 1,
      "responseIdentifier": "RESPONSE"
    }
  },
  "responseDeclarations": [
    {
      "correct": "D",
      "baseType": "identifier",
      "identifier": "RESPONSE",
      "cardinality": "single"
    }
  ]
}
```

### Relevant code
- Widget registry — src/lib/widgets/generators/index.ts
```
import { generateVennDiagram, VennDiagramPropsSchema } from "./venn-diagram"
import { generateVerticalArithmeticSetup, VerticalArithmeticSetupPropsSchema } from "./vertical-arithmetic-setup"

// The `type` field is now included in the base schemas, so we remove .extend()
export const typedSchemas = {
	"3dIntersectionDiagram": ThreeDIntersectionDiagramPropsSchema,
	absoluteValueNumberLine: AbsoluteValueNumberLinePropsSchema,
	angleDiagram: AngleDiagramPropsSchema,
	barChart: BarChartPropsSchema,
	boxGrid: BoxGridPropsSchema,
	boxPlot: BoxPlotPropsSchema,
	circleDiagram: CircleDiagramPropsSchema,
	compositeShapeDiagram: CompositeShapeDiagramPropsSchema,
	coordinatePlane: CoordinatePlaneComprehensivePropsSchema,
	distanceFormulaGraph: DistanceFormulaGraphPropsSchema,
	functionPlotGraph: FunctionPlotGraphPropsSchema,
	lineEquationGraph: LineEquationGraphPropsSchema,
	pointPlotGraph: PointPlotGraphPropsSchema,
	polygonGraph: PolygonGraphPropsSchema,
	shapeTransformationGraph: ShapeTransformationGraphPropsSchema,
	dataTable: DataTablePropsSchema,
	discreteObjectRatioDiagram: DiscreteObjectRatioDiagramPropsSchema,
	dotPlot: DotPlotPropsSchema,
	doubleNumberLine: DoubleNumberLinePropsSchema,
	emojiImage: EmojiImagePropsSchema,
	figureComparisonDiagram: FigureComparisonDiagramPropsSchema,
	fractionNumberLine: FractionNumberLinePropsSchema,
	geometricSolidDiagram: GeometricSolidDiagramPropsSchema,
	hangerDiagram: HangerDiagramPropsSchema,
	histogram: HistogramPropsSchema,
	inequalityNumberLine: InequalityNumberLinePropsSchema,
	numberLine: NumberLinePropsSchema,
	numberLineForOpposites: NumberLineForOppositesPropsSchema,
	numberLineWithAction: NumberLineWithActionPropsSchema,
	numberLineWithFractionGroups: NumberLineWithFractionGroupsPropsSchema,
	numberSetDiagram: NumberSetDiagramPropsSchema,
	partitionedShape: PartitionedShapePropsSchema,
	pentagonIntersectionDiagram: PentagonIntersectionDiagramPropsSchema,
	pictograph: PictographPropsSchema,
	polyhedronDiagram: PolyhedronDiagramPropsSchema,
	probabilitySpinner: ProbabilitySpinnerPropsSchema,
	polyhedronNetDiagram: PolyhedronNetDiagramPropsSchema,
	pythagoreanProofDiagram: PythagoreanProofDiagramPropsSchema,
	ratioBoxDiagram: RatioBoxDiagramPropsSchema,
	rectangularFrameDiagram: RectangularFrameDiagramPropsSchema,
	scaleCopiesSlider: ScaleCopiesSliderPropsSchema,
```

- Compiler finalization (missing URL hardening) — src/lib/qti-generation/compiler.ts
```
	finalXml = stripXmlComments(finalXml, logger)
	finalXml = removeDoubleNewlines(finalXml, logger)
	finalXml = fixMathMLOperators(finalXml, logger)
	finalXml = fixInequalityOperators(finalXml, logger)
	// Convert HTML entities to Unicode characters at the very end
	return convertHtmlEntities(finalXml, logger)
}

```
