# Choose the graph of the inequality x > -4

- **analysisId**: b8d0211a-b677-4af9-add3-a6c91b525993
- **questionId**: x0ea6ddf2623b5753
- **severity**: major

### Issue
number line ticks way too small

### Perseus (original)
```json
{
  "hints": [
    {
      "images": {},
      "content": "The inequality $x>-4$  is read as $x$ is greater than $-4$.",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "So, we need to graph all values that are greater than $-4$.",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {
        "web+graphie://cdn.kastatic.org/ka-perseus-graphie/052d2a0ad7e0ed0ebced52ff22605478f0cdb0e0": {
          "width": 360,
          "height": 48
        }
      },
      "content": "**The answer:**\n\n![](web+graphie://cdn.kastatic.org/ka-perseus-graphie/052d2a0ad7e0ed0ebced52ff22605478f0cdb0e0)",
      "replace": false,
      "widgets": {}
    }
  ],
  "question": {
    "images": {},
    "content": "**Choose the graph of the inequality  $x>-4$.**\n\n[[☃ radio 1]]",
    "widgets": {
      "radio 1": {
        "type": "radio",
        "graded": true,
        "static": false,
        "options": {
          "choices": [
            {
              "clue": "This graph shows $x<-4$.",
              "content": "![A number line from negative 5 to 5 with evenly spaced tick marks in increments of 1. An open point is plotted at negative 4. A line running to the left starts at negative 4 and continues.](web+graphie://cdn.kastatic.org/ka-perseus-graphie/889b8a05a19f7dfc62e3846d4362eccbacb58931)",
              "correct": false
            },
            {
              "clue": "This graph shows $x=-4$.",
              "content": "![A number line from negative 5 to 5 with evenly spaced tick marks in increments of 1. A closed point is plotted at negative 4.](web+graphie://cdn.kastatic.org/ka-perseus-graphie/c4d51ba5c9fbfb5590f3241553f36fbead0e2d4a)",
              "correct": false
            },
            {
              "clue": "This graph shows $x<4$.",
              "content": "![A number line from negative 5 to 5 with evenly spaced tick marks in increments of 1. An open point is plotted at 4. A line running to the left starts at 4 and continues.](web+graphie://cdn.kastatic.org/ka-perseus-graphie/3bcf9457a8ccfcc572a451a55eb860060c5ad671)",
              "correct": false,
              "isNoneOfTheAbove": false
            },
            {
              "content": "\n\n![A number line from negative 5 to 5 with evenly spaced tick marks in increments of 1. An open point is plotted at negative 4. A line running to the right starts at negative 4 and continues.](web+graphie://cdn.kastatic.org/ka-perseus-graphie/052d2a0ad7e0ed0ebced52ff22605478f0cdb0e0)",
              "correct": true,
              "isNoneOfTheAbove": false
            }
          ],
          "randomize": false,
          "countChoices": false,
          "displayCount": null,
          "multipleSelect": false,
          "deselectEnabled": false,
          "hasNoneOfTheAbove": false
        },
        "version": {
          "major": 1,
          "minor": 0
        },
        "alignment": "default"
      }
    }
  },
  "answerArea": {
    "tTable": false,
    "zTable": false,
    "chi2Table": false,
    "calculator": false,
    "periodicTable": false
  },
  "itemDataVersion": {
    "major": 0,
    "minor": 1
  }
}
```

### Structured JSON (generated)
```json
{
  "body": [
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "Choose the graph of the inequality "
        },
        {
          "type": "math",
          "mathml": "<mi>x</mi><mo>&gt;</mo><mo>-</mo><mn>4</mn>"
        },
        {
          "type": "text",
          "content": "."
        }
      ]
    },
    {
      "type": "blockSlot",
      "slotId": "choice_a_graph"
    },
    {
      "type": "blockSlot",
      "slotId": "choice_b_graph"
    },
    {
      "type": "blockSlot",
      "slotId": "choice_c_graph"
    },
    {
      "type": "blockSlot",
      "slotId": "choice_d_graph"
    },
    {
      "type": "blockSlot",
      "slotId": "choice_interaction"
    }
  ],
  "title": "Choose the graph of the inequality x > -4",
  "widgets": {
    "choice_a_graph": {
      "max": 5,
      "min": -5,
      "type": "inequalityNumberLine",
      "width": 1200,
      "height": 200,
      "ranges": [
        {
          "end": {
            "type": "open",
            "value": -4
          },
          "color": "#1f77b4",
          "start": null
        }
      ],
      "tickInterval": 1
    },
    "choice_b_graph": {
      "max": 5,
      "min": -5,
      "type": "numberLine",
      "width": 1200,
      "height": 200,
      "points": [
        {
          "color": "#1f77b4",
          "label": "",
          "value": -4,
          "labelPosition": "above"
        }
      ],
      "orientation": "horizontal",
      "majorTickInterval": 1,
      "specialTickLabels": null,
      "minorTicksPerInterval": 0
    },
    "choice_c_graph": {
      "max": 5,
      "min": -5,
      "type": "inequalityNumberLine",
      "width": 1200,
      "height": 200,
      "ranges": [
        {
          "end": {
            "type": "open",
            "value": 4
          },
          "color": "#1f77b4",
          "start": null
        }
      ],
      "tickInterval": 1
    },
    "choice_d_graph": {
      "max": 5,
      "min": -5,
      "type": "inequalityNumberLine",
      "width": 1200,
      "height": 200,
      "ranges": [
        {
          "end": null,
          "color": "#1f77b4",
          "start": {
            "type": "open",
            "value": -4
          }
        }
      ],
      "tickInterval": 1
    }
  },
  "feedback": {
    "correct": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Correct! The inequality "
          },
          {
            "type": "math",
            "mathml": "<mi>x</mi><mo>&gt;</mo><mo>-</mo><mn>4</mn>"
          },
          {
            "type": "text",
            "content": " means all values of "
          },
          {
            "type": "math",
            "mathml": "<mi>x</mi>"
          },
          {
            "type": "text",
            "content": " greater than "
          },
          {
            "type": "math",
            "mathml": "<mo>-</mo><mn>4</mn>"
          },
          {
            "type": "text",
            "content": ". On a number line, that is shown with an open point at "
          },
          {
            "type": "math",
            "mathml": "<mo>-</mo><mn>4</mn>"
          },
          {
            "type": "text",
            "content": " and a ray to the right."
          }
        ]
      }
    ],
    "incorrect": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Not quite. The inequality "
          },
          {
            "type": "math",
            "mathml": "<mi>x</mi><mo>&gt;</mo><mo>-</mo><mn>4</mn>"
          },
          {
            "type": "text",
            "content": " is read as "
          },
          {
            "type": "math",
            "mathml": "<mi>x</mi>"
          },
          {
            "type": "text",
            "content": " is greater than "
          },
          {
            "type": "math",
            "mathml": "<mo>-</mo><mn>4</mn>"
          },
          {
            "type": "text",
            "content": ". Graph all numbers greater than "
          },
          {
            "type": "math",
            "mathml": "<mo>-</mo><mn>4</mn>"
          },
          {
            "type": "text",
            "content": " with an open point at "
          },
          {
            "type": "math",
            "mathml": "<mo>-</mo><mn>4</mn>"
          },
          {
            "type": "text",
            "content": " and a ray extending to the right."
          }
        ]
      }
    ]
  },
  "identifier": "choose-inequality-graph-x-gt-neg4",
  "interactions": {
    "choice_interaction": {
      "type": "choiceInteraction",
      "prompt": [
        {
          "type": "text",
          "content": "Choose the graph of the inequality "
        },
        {
          "type": "math",
          "mathml": "<mi>x</mi><mo>&gt;</mo><mo>-</mo><mn>4</mn>"
        },
        {
          "type": "text",
          "content": "."
        }
      ],
      "choices": [
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "content": "A"
                }
              ]
            }
          ],
          "feedback": [
            {
              "type": "text",
              "content": "This graph shows "
            },
            {
              "type": "math",
              "mathml": "<mi>x</mi><mo>&lt;</mo><mo>-</mo><mn>4</mn>"
            },
            {
              "type": "text",
              "content": "."
            }
          ],
          "identifier": "A"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "content": "B"
                }
              ]
            }
          ],
          "feedback": [
            {
              "type": "text",
              "content": "This graph shows "
            },
            {
              "type": "math",
              "mathml": "<mi>x</mi><mo>=</mo><mo>-</mo><mn>4</mn>"
            },
            {
              "type": "text",
              "content": "."
            }
          ],
          "identifier": "B"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "content": "C"
                }
              ]
            }
          ],
          "feedback": [
            {
              "type": "text",
              "content": "This graph shows "
            },
            {
              "type": "math",
              "mathml": "<mi>x</mi><mo>&lt;</mo><mn>4</mn>"
            },
            {
              "type": "text",
              "content": "."
            }
          ],
          "identifier": "C"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "content": "D"
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "D"
        }
      ],
      "shuffle": true,
      "maxChoices": 1,
      "minChoices": 1,
      "responseIdentifier": "RESPONSE"
    }
  },
  "responseDeclarations": [
    {
      "correct": "D",
      "baseType": "identifier",
      "identifier": "RESPONSE",
      "cardinality": "single"
    }
  ]
}
```

### Relevant code
- Widget registry — src/lib/widgets/generators/index.ts
```
import { generateVennDiagram, VennDiagramPropsSchema } from "./venn-diagram"
import { generateVerticalArithmeticSetup, VerticalArithmeticSetupPropsSchema } from "./vertical-arithmetic-setup"

// The `type` field is now included in the base schemas, so we remove .extend()
export const typedSchemas = {
	"3dIntersectionDiagram": ThreeDIntersectionDiagramPropsSchema,
	absoluteValueNumberLine: AbsoluteValueNumberLinePropsSchema,
	angleDiagram: AngleDiagramPropsSchema,
	barChart: BarChartPropsSchema,
	boxGrid: BoxGridPropsSchema,
	boxPlot: BoxPlotPropsSchema,
	circleDiagram: CircleDiagramPropsSchema,
	compositeShapeDiagram: CompositeShapeDiagramPropsSchema,
	coordinatePlane: CoordinatePlaneComprehensivePropsSchema,
	distanceFormulaGraph: DistanceFormulaGraphPropsSchema,
	functionPlotGraph: FunctionPlotGraphPropsSchema,
	lineEquationGraph: LineEquationGraphPropsSchema,
	pointPlotGraph: PointPlotGraphPropsSchema,
	polygonGraph: PolygonGraphPropsSchema,
	shapeTransformationGraph: ShapeTransformationGraphPropsSchema,
	dataTable: DataTablePropsSchema,
	discreteObjectRatioDiagram: DiscreteObjectRatioDiagramPropsSchema,
	dotPlot: DotPlotPropsSchema,
	doubleNumberLine: DoubleNumberLinePropsSchema,
	emojiImage: EmojiImagePropsSchema,
	figureComparisonDiagram: FigureComparisonDiagramPropsSchema,
	fractionNumberLine: FractionNumberLinePropsSchema,
	geometricSolidDiagram: GeometricSolidDiagramPropsSchema,
	hangerDiagram: HangerDiagramPropsSchema,
	histogram: HistogramPropsSchema,
	inequalityNumberLine: InequalityNumberLinePropsSchema,
	numberLine: NumberLinePropsSchema,
	numberLineForOpposites: NumberLineForOppositesPropsSchema,
	numberLineWithAction: NumberLineWithActionPropsSchema,
	numberLineWithFractionGroups: NumberLineWithFractionGroupsPropsSchema,
	numberSetDiagram: NumberSetDiagramPropsSchema,
	partitionedShape: PartitionedShapePropsSchema,
	pentagonIntersectionDiagram: PentagonIntersectionDiagramPropsSchema,
	pictograph: PictographPropsSchema,
	polyhedronDiagram: PolyhedronDiagramPropsSchema,
	probabilitySpinner: ProbabilitySpinnerPropsSchema,
	polyhedronNetDiagram: PolyhedronNetDiagramPropsSchema,
	pythagoreanProofDiagram: PythagoreanProofDiagramPropsSchema,
	ratioBoxDiagram: RatioBoxDiagramPropsSchema,
	rectangularFrameDiagram: RectangularFrameDiagramPropsSchema,
	scaleCopiesSlider: ScaleCopiesSliderPropsSchema,
```

- Compiler finalization (missing URL hardening) — src/lib/qti-generation/compiler.ts
```
	finalXml = stripXmlComments(finalXml, logger)
	finalXml = removeDoubleNewlines(finalXml, logger)
	finalXml = fixMathMLOperators(finalXml, logger)
	finalXml = fixInequalityOperators(finalXml, logger)
	// Convert HTML entities to Unicode characters at the very end
	return convertHtmlEntities(finalXml, logger)
}

```

### Root cause analysis
- Widget generators lack fine-grained layout controls for label spacing, tick sizing, and overlays (e.g., best-fit lines).
- Some required annotations (e.g., heights, arcs) aren’t dynamically computed or placed to avoid overlaps.

### Proposed fixes
- Add layout parameters (label offsets, min separation, collision avoidance) and derive sensible defaults per widget.
- Implement overlay support (e.g., regression line) where pedagogy demands it.
- Introduce visual QA validators to detect unreadable overlaps or missing required annotations.
