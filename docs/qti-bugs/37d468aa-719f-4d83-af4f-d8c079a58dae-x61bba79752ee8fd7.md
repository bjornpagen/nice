# Find the value of x in a triangle

- **analysisId**: 37d468aa-719f-4d83-af4f-d8c079a58dae
- **questionId**: x61bba79752ee8fd7
- **severity**: minor

### Issue
There should not be labeled points on the triangle. More acute angles should be father from their center point to ensure that the label is readable and not overlapped by nearby lines.

### Perseus (original)
```json
{
  "hints": [
    {
      "images": {},
      "content": "The three angles in a triangle add up to $180 ^\\circ$.",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "We can write this as an equation:\n\n>$x^\\circ + 27^\\circ + 82^\\circ = 180^\\circ$",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "The missing angle is $180^\\circ$ minus the measures of the other two angles:\n\n>$x^\\circ = 180^\\circ - 82^\\circ - 27^\\circ$",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "The answer:\n\n>$x = 71^\\circ$",
      "replace": false,
      "widgets": {}
    }
  ],
  "question": {
    "images": {},
    "content": "**Find the value of $x$ in the triangle shown below.**\n\n$x = $ [[☃ numeric-input 1]] $^\\circ$\n\n\n\n[[☃ image 1]]\n\n",
    "widgets": {
      "image 1": {
        "type": "image",
        "graded": true,
        "static": false,
        "options": {
          "alt": "A triangle. The top, left angle measure is x degrees. The top, right most angle measure is 27 degrees. The bottom, left angle measure is 82 degrees.",
          "box": [
            300,
            150
          ],
          "range": [
            [
              0,
              10
            ],
            [
              0,
              10
            ]
          ],
          "title": "",
          "labels": [],
          "static": false,
          "caption": "",
          "backgroundImage": {
            "url": "web+graphie://cdn.kastatic.org/ka-perseus-graphie/8d31fd7fdb68464d29662fc1b11771fea9221d6a",
            "width": 300,
            "height": 150
          }
        },
        "version": {
          "major": 0,
          "minor": 0
        },
        "alignment": "block"
      },
      "numeric-input 1": {
        "type": "numeric-input",
        "graded": true,
        "static": false,
        "options": {
          "size": "normal",
          "static": false,
          "answers": [
            {
              "value": 71,
              "status": "correct",
              "strict": false,
              "message": "",
              "maxError": null,
              "simplify": "required"
            }
          ],
          "labelText": "",
          "rightAlign": false,
          "coefficient": false,
          "multipleNumberInput": false
        },
        "version": {
          "major": 0,
          "minor": 0
        },
        "alignment": "default"
      }
    }
  },
  "answerArea": {
    "tTable": false,
    "zTable": false,
    "chi2Table": false,
    "calculator": false,
    "periodicTable": false
  },
  "itemDataVersion": {
    "major": 0,
    "minor": 1
  }
}
```

### Structured JSON (generated)
```json
{
  "body": [
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "Find the value of "
        },
        {
          "type": "math",
          "mathml": "<mi>x</mi>"
        },
        {
          "type": "text",
          "content": " in the triangle shown below."
        }
      ]
    },
    {
      "type": "paragraph",
      "content": [
        {
          "type": "math",
          "mathml": "<mi>x</mi><mo>=</mo>"
        },
        {
          "type": "inlineSlot",
          "slotId": "text_entry"
        },
        {
          "type": "text",
          "content": " "
        },
        {
          "type": "math",
          "mathml": "<mo>°</mo>"
        }
      ]
    },
    {
      "type": "blockSlot",
      "slotId": "triangle_image"
    }
  ],
  "title": "Find the value of x in a triangle",
  "widgets": {
    "triangle_image": {
      "type": "triangleDiagram",
      "sides": [
        {
          "label": "",
          "vertices": [
            "A",
            "B"
          ],
          "tickMarks": 0
        },
        {
          "label": "",
          "vertices": [
            "B",
            "C"
          ],
          "tickMarks": 0
        },
        {
          "label": "",
          "vertices": [
            "C",
            "A"
          ],
          "tickMarks": 0
        }
      ],
      "width": 300,
      "angles": [
        {
          "color": "#000000",
          "label": "x°",
          "radius": 20,
          "showArc": true,
          "vertices": [
            "B",
            "A",
            "C"
          ],
          "isRightAngle": false
        },
        {
          "color": "#000000",
          "label": "27°",
          "radius": 20,
          "showArc": true,
          "vertices": [
            "A",
            "C",
            "B"
          ],
          "isRightAngle": false
        },
        {
          "color": "#000000",
          "label": "82°",
          "radius": 22,
          "showArc": true,
          "vertices": [
            "A",
            "B",
            "C"
          ],
          "isRightAngle": false
        }
      ],
      "height": 150,
      "points": [
        {
          "x": 18.75,
          "y": 18.75,
          "id": "A",
          "label": "A"
        },
        {
          "x": 56.25,
          "y": 131.25,
          "id": "B",
          "label": "B"
        },
        {
          "x": 281.25,
          "y": 18.75,
          "id": "C",
          "label": "C"
        }
      ],
      "internalLines": null,
      "shadedRegions": null
    }
  },
  "feedback": {
    "correct": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Correct! The value of "
          },
          {
            "type": "math",
            "mathml": "<mi>x</mi>"
          },
          {
            "type": "text",
            "content": " is "
          },
          {
            "type": "math",
            "mathml": "<mn>71</mn><mo>°</mo>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      }
    ],
    "incorrect": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "The three angles in a triangle add up to "
          },
          {
            "type": "math",
            "mathml": "<mn>180</mn><mo>°</mo>"
          },
          {
            "type": "text",
            "content": "."
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "We can write this as an equation:"
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "math",
            "mathml": "<mi>x</mi><mo>°</mo><mo>+</mo><mn>27</mn><mo>°</mo><mo>+</mo><mn>82</mn><mo>°</mo><mo>=</mo><mn>180</mn><mo>°</mo>"
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "The missing angle is "
          },
          {
            "type": "math",
            "mathml": "<mn>180</mn><mo>°</mo><mo>-</mo><mn>82</mn><mo>°</mo><mo>-</mo><mn>27</mn><mo>°</mo>"
          },
          {
            "type": "text",
            "content": ", so"
          }
        ]
      },
      {
        "type": "paragraph",
        "content": [
          {
            "type": "math",
            "mathml": "<mi>x</mi><mo>°</mo><mo>=</mo><mn>180</mn><mo>°</mo><mo>-</mo><mn>82</mn><mo>°</mo><mo>-</mo><mn>27</mn><mo>°</mo><mo>=</mo><mn>71</mn><mo>°</mo>"
          }
        ]
      }
    ]
  },
  "identifier": "find-x-in-triangle-sum-of-angles",
  "interactions": {
    "text_entry": {
      "type": "textEntryInteraction",
      "expectedLength": 2,
      "responseIdentifier": "RESPONSE"
    }
  },
  "responseDeclarations": [
    {
      "correct": 71,
      "baseType": "integer",
      "identifier": "RESPONSE",
      "cardinality": "single"
    }
  ]
}
```

### Relevant code
- Widget registry — src/lib/widgets/generators/index.ts
```
import { generateVennDiagram, VennDiagramPropsSchema } from "./venn-diagram"
import { generateVerticalArithmeticSetup, VerticalArithmeticSetupPropsSchema } from "./vertical-arithmetic-setup"

// The `type` field is now included in the base schemas, so we remove .extend()
export const typedSchemas = {
	"3dIntersectionDiagram": ThreeDIntersectionDiagramPropsSchema,
	absoluteValueNumberLine: AbsoluteValueNumberLinePropsSchema,
	angleDiagram: AngleDiagramPropsSchema,
	barChart: BarChartPropsSchema,
	boxGrid: BoxGridPropsSchema,
	boxPlot: BoxPlotPropsSchema,
	circleDiagram: CircleDiagramPropsSchema,
	compositeShapeDiagram: CompositeShapeDiagramPropsSchema,
	coordinatePlane: CoordinatePlaneComprehensivePropsSchema,
	distanceFormulaGraph: DistanceFormulaGraphPropsSchema,
	functionPlotGraph: FunctionPlotGraphPropsSchema,
	lineEquationGraph: LineEquationGraphPropsSchema,
	pointPlotGraph: PointPlotGraphPropsSchema,
	polygonGraph: PolygonGraphPropsSchema,
	shapeTransformationGraph: ShapeTransformationGraphPropsSchema,
	dataTable: DataTablePropsSchema,
	discreteObjectRatioDiagram: DiscreteObjectRatioDiagramPropsSchema,
	dotPlot: DotPlotPropsSchema,
	doubleNumberLine: DoubleNumberLinePropsSchema,
	emojiImage: EmojiImagePropsSchema,
	figureComparisonDiagram: FigureComparisonDiagramPropsSchema,
	fractionNumberLine: FractionNumberLinePropsSchema,
	geometricSolidDiagram: GeometricSolidDiagramPropsSchema,
	hangerDiagram: HangerDiagramPropsSchema,
	histogram: HistogramPropsSchema,
	inequalityNumberLine: InequalityNumberLinePropsSchema,
	numberLine: NumberLinePropsSchema,
	numberLineForOpposites: NumberLineForOppositesPropsSchema,
	numberLineWithAction: NumberLineWithActionPropsSchema,
	numberLineWithFractionGroups: NumberLineWithFractionGroupsPropsSchema,
	numberSetDiagram: NumberSetDiagramPropsSchema,
	partitionedShape: PartitionedShapePropsSchema,
	pentagonIntersectionDiagram: PentagonIntersectionDiagramPropsSchema,
	pictograph: PictographPropsSchema,
	polyhedronDiagram: PolyhedronDiagramPropsSchema,
	probabilitySpinner: ProbabilitySpinnerPropsSchema,
	polyhedronNetDiagram: PolyhedronNetDiagramPropsSchema,
	pythagoreanProofDiagram: PythagoreanProofDiagramPropsSchema,
	ratioBoxDiagram: RatioBoxDiagramPropsSchema,
	rectangularFrameDiagram: RectangularFrameDiagramPropsSchema,
	scaleCopiesSlider: ScaleCopiesSliderPropsSchema,
```

- Compiler finalization (missing URL hardening) — src/lib/qti-generation/compiler.ts
```
	finalXml = stripXmlComments(finalXml, logger)
	finalXml = removeDoubleNewlines(finalXml, logger)
	finalXml = fixMathMLOperators(finalXml, logger)
	finalXml = fixInequalityOperators(finalXml, logger)
	// Convert HTML entities to Unicode characters at the very end
	return convertHtmlEntities(finalXml, logger)
}

```
