# Which line fits the data?

- **analysisId**: eb73d491-8e44-4c17-b2bf-c78d261d2b68
- **questionId**: x0f25c2a2befde7fe
- **severity**: major

### Issue
no best fit lines are drawn, no best fit line line in the scatter plot.

### Perseus (original)
```json
{
  "hints": [
    {
      "images": {},
      "content": "No *single* line represents all of the given data.",
      "replace": false,
      "widgets": {}
    },
    {
      "images": {},
      "content": "None of the lines fit the data.",
      "replace": false,
      "widgets": {}
    }
  ],
  "question": {
    "images": {},
    "content": "**Which line fits the data graphed below?**\n\n[[☃ radio 2]]\n\n\n[[☃ image 1]]\n\n",
    "widgets": {
      "image 1": {
        "type": "image",
        "graded": true,
        "static": false,
        "options": {
          "alt": "A scatterplot on the x y axis where x and y scale by 1. Points rise diagonally from (1 half, 1) in a narrow scatter toward (5, 4) then back towards (9, 1 and 1 half). A line labeled A decreases diagonally extending from (0, 9) through (8, 3). A line labeled B increases diagonally extending from (0, 2) through (8, 8). A line labeled C decreases diagonally extending from (0, 4) through (10, 5'). All values are estimated.",
          "box": [
            425,
            425
          ],
          "range": [
            [
              0,
              10
            ],
            [
              0,
              10
            ]
          ],
          "title": "",
          "labels": [],
          "static": false,
          "caption": "",
          "backgroundImage": {
            "url": "web+graphie://cdn.kastatic.org/ka-perseus-graphie/4888dda3a81f5696ca953414d9fcbcdbe5d81fea",
            "width": 425,
            "height": 425
          }
        },
        "version": {
          "major": 0,
          "minor": 0
        },
        "alignment": "block"
      },
      "radio 2": {
        "type": "radio",
        "graded": true,
        "static": false,
        "options": {
          "choices": [
            {
              "content": "$\\maroonD{\\text{A}}$",
              "correct": false
            },
            {
              "content": "$\\goldD{\\text{B}}$",
              "correct": false
            },
            {
              "content": "$\\greenD{\\text{C}}$",
              "correct": false,
              "isNoneOfTheAbove": false
            },
            {
              "content": "None of the lines fit the data.",
              "correct": true,
              "isNoneOfTheAbove": false
            }
          ],
          "randomize": false,
          "onePerLine": false,
          "displayCount": null,
          "multipleSelect": false,
          "deselectEnabled": false,
          "hasNoneOfTheAbove": false
        },
        "version": {
          "major": 1,
          "minor": 0
        },
        "alignment": "default"
      }
    }
  },
  "answerArea": {
    "tTable": false,
    "zTable": false,
    "chi2Table": false,
    "calculator": false,
    "periodicTable": false
  },
  "itemDataVersion": {
    "major": 0,
    "minor": 1
  }
}
```

### Structured JSON (generated)
```json
{
  "body": [
    {
      "type": "paragraph",
      "content": [
        {
          "type": "text",
          "content": "Which line fits the data graphed below?"
        }
      ]
    },
    {
      "type": "blockSlot",
      "slotId": "data_graph_widget"
    },
    {
      "type": "blockSlot",
      "slotId": "choice_interaction"
    }
  ],
  "title": "Which line fits the data?",
  "widgets": {
    "data_graph_widget": {
      "type": "scatterPlot",
      "title": "",
      "width": 425,
      "xAxis": {
        "max": 10,
        "min": 0,
        "label": "x",
        "gridLines": true,
        "tickInterval": 1
      },
      "yAxis": {
        "max": 10,
        "min": 0,
        "label": "y",
        "gridLines": true,
        "tickInterval": 1
      },
      "height": 425,
      "points": [
        {
          "x": 1,
          "y": 2,
          "label": ""
        },
        {
          "x": 2,
          "y": 3.3,
          "label": ""
        },
        {
          "x": 2.5,
          "y": 3.5,
          "label": ""
        },
        {
          "x": 0.5,
          "y": 1,
          "label": ""
        },
        {
          "x": 3,
          "y": 4,
          "label": ""
        },
        {
          "x": 5,
          "y": 5,
          "label": ""
        },
        {
          "x": 4,
          "y": 4.5,
          "label": ""
        },
        {
          "x": 6,
          "y": 4.2,
          "label": ""
        },
        {
          "x": 6,
          "y": 3.7,
          "label": ""
        },
        {
          "x": 8,
          "y": 2.7,
          "label": ""
        },
        {
          "x": 7,
          "y": 3.4,
          "label": ""
        },
        {
          "x": 9,
          "y": 1.7,
          "label": ""
        }
      ],
      "trendLine": null
    }
  },
  "feedback": {
    "correct": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Correct! None of the lines fit the data. The scatter of points rises and then falls, so a single straight line does not represent all of the data."
          }
        ]
      }
    ],
    "incorrect": [
      {
        "type": "paragraph",
        "content": [
          {
            "type": "text",
            "content": "Not quite. No single line represents all of the given data."
          }
        ]
      }
    ]
  },
  "identifier": "which-line-fits-data-mc",
  "interactions": {
    "choice_interaction": {
      "type": "choiceInteraction",
      "prompt": [
        {
          "type": "text",
          "content": "Which line fits the data graphed below?"
        }
      ],
      "choices": [
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "content": "A"
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "A"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "content": "B"
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "B"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "content": "C"
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "C"
        },
        {
          "content": [
            {
              "type": "paragraph",
              "content": [
                {
                  "type": "text",
                  "content": "None of the lines fit the data."
                }
              ]
            }
          ],
          "feedback": null,
          "identifier": "D"
        }
      ],
      "shuffle": true,
      "maxChoices": 1,
      "minChoices": 1,
      "responseIdentifier": "RESPONSE"
    }
  },
  "responseDeclarations": [
    {
      "correct": "D",
      "baseType": "identifier",
      "identifier": "RESPONSE",
      "cardinality": "single"
    }
  ]
}
```

### Relevant code
- Widget registry — src/lib/widgets/generators/index.ts
```
import { generateVennDiagram, VennDiagramPropsSchema } from "./venn-diagram"
import { generateVerticalArithmeticSetup, VerticalArithmeticSetupPropsSchema } from "./vertical-arithmetic-setup"

// The `type` field is now included in the base schemas, so we remove .extend()
export const typedSchemas = {
	"3dIntersectionDiagram": ThreeDIntersectionDiagramPropsSchema,
	absoluteValueNumberLine: AbsoluteValueNumberLinePropsSchema,
	angleDiagram: AngleDiagramPropsSchema,
	barChart: BarChartPropsSchema,
	boxGrid: BoxGridPropsSchema,
	boxPlot: BoxPlotPropsSchema,
	circleDiagram: CircleDiagramPropsSchema,
	compositeShapeDiagram: CompositeShapeDiagramPropsSchema,
	coordinatePlane: CoordinatePlaneComprehensivePropsSchema,
	distanceFormulaGraph: DistanceFormulaGraphPropsSchema,
	functionPlotGraph: FunctionPlotGraphPropsSchema,
	lineEquationGraph: LineEquationGraphPropsSchema,
	pointPlotGraph: PointPlotGraphPropsSchema,
	polygonGraph: PolygonGraphPropsSchema,
	shapeTransformationGraph: ShapeTransformationGraphPropsSchema,
	dataTable: DataTablePropsSchema,
	discreteObjectRatioDiagram: DiscreteObjectRatioDiagramPropsSchema,
	dotPlot: DotPlotPropsSchema,
	doubleNumberLine: DoubleNumberLinePropsSchema,
	emojiImage: EmojiImagePropsSchema,
	figureComparisonDiagram: FigureComparisonDiagramPropsSchema,
	fractionNumberLine: FractionNumberLinePropsSchema,
	geometricSolidDiagram: GeometricSolidDiagramPropsSchema,
	hangerDiagram: HangerDiagramPropsSchema,
	histogram: HistogramPropsSchema,
	inequalityNumberLine: InequalityNumberLinePropsSchema,
	numberLine: NumberLinePropsSchema,
	numberLineForOpposites: NumberLineForOppositesPropsSchema,
	numberLineWithAction: NumberLineWithActionPropsSchema,
	numberLineWithFractionGroups: NumberLineWithFractionGroupsPropsSchema,
	numberSetDiagram: NumberSetDiagramPropsSchema,
	partitionedShape: PartitionedShapePropsSchema,
	pentagonIntersectionDiagram: PentagonIntersectionDiagramPropsSchema,
	pictograph: PictographPropsSchema,
	polyhedronDiagram: PolyhedronDiagramPropsSchema,
	probabilitySpinner: ProbabilitySpinnerPropsSchema,
	polyhedronNetDiagram: PolyhedronNetDiagramPropsSchema,
	pythagoreanProofDiagram: PythagoreanProofDiagramPropsSchema,
	ratioBoxDiagram: RatioBoxDiagramPropsSchema,
	rectangularFrameDiagram: RectangularFrameDiagramPropsSchema,
	scaleCopiesSlider: ScaleCopiesSliderPropsSchema,
```

- Compiler finalization (missing URL hardening) — src/lib/qti-generation/compiler.ts
```
	finalXml = stripXmlComments(finalXml, logger)
	finalXml = removeDoubleNewlines(finalXml, logger)
	finalXml = fixMathMLOperators(finalXml, logger)
	finalXml = fixInequalityOperators(finalXml, logger)
	// Convert HTML entities to Unicode characters at the very end
	return convertHtmlEntities(finalXml, logger)
}

```
